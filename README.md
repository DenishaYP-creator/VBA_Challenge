# VBA_Challenge
Code Refractoring Project of Stock Analysis Project: Performance Code Improvement 

# VBA Challenge All Stock Analysis 

### PROJECT BACKGROUND 
Our client Steve is a financial analyst in need of an excel workbook that will analyze large amounts of stock data at the click of a button. In this project, we will utilize the All-Stock Analysis workbook from a project previously completed for Steve. The workbook All Stock analysis was created to analyze stock datasets but at a smaller scale. By utilizing the existing code, we can deliver the project early and at a lower cost

### PURPOSE
The purpose of this report is to documents the refracting process of the initial All-Stock Analysis workbook code provided to our client Steve. 

### GOAL 
During the refracting process, we will edit & cleanse the code in the existing All Stock Analysis. The goal is to make the All-Stock Analysis workbook work more efficiently by reducing the time it takes to loop/scan that dataset. Upon delivery of the project, the new workbook will analyze large amounts of stock datasets quickly, at the click of a button.

# LOGICAL WORKFLOW 

## Refracted Code 1
[![Refraced-Code1.png](https://i.postimg.cc/261Jzhpz/Refraced-Code1.png)](https://postimg.cc/gXP4swk5)

## Code Perfromance Imporvement  

#### Step 1a: Create a ticker Index

#### Step 1b: Create three output arrays 

#### Step 2a: Create a for loop to initialize the tickerVolumes to zero. 

#### Step 2b: Loop over all the rows in the spreadsheet.

#### Refracted Code 2:  Loop through rows in the data

#### Step 3a: Increase volume for current ticker

#### Step 3b: Check if the current row is the first row with the selected tickerIndex. If  Then End If

#### Step 3c:Check if the current row is the last row with the selected ticker 'If  Then

#### Step 3d: Increase the tickerIndex. 

#### Step 4:Loop through your arrays to output the Ticker, TickerVolumes, TickerStartingPrices, TickerEndingPrinces 'to ourput the "Ticker", Total Daily Volume, & Return ..

[![Steps-1a-4-Performance-Imporvement.png](https://i.postimg.cc/xC5Qz0k8/Steps-1a-4-Performance-Imporvement.png)](https://postimg.cc/vg4CRwtw)


###Refracted Code 3:
[![Refracted-Code-3.png](https://i.postimg.cc/VNg1SjHn/Refracted-Code-3.png)](https://postimg.cc/HJrFR7mk)			


## Workbook Performance Findings 

The 2018 and 2017 VBA Challenge workbook performance output improved compared to the All Stock Analysis worksheet performance. Upon Executing VBA Challenge workbook an output was generated in 0.0625 seconds for both years compared to 3.21875 seconds output for the 2017 All Stock Analysis workbook and 3.265625 seconds output for that 2018 All Stock 

## Analysis of Workbook.
The following demonstrated the difference in performance speed based on year and workbook name. 

## Workbook Performance Results
[![Result-Table.png](https://i.postimg.cc/Z5rfPNyq/Result-Table.png)](https://postimg.cc/FYHgN7pt)


## Advantages of Refracting: 
•	Reduces the amount of time spent on the project 
•	Ability to compare speed performance 

## Disadvantages 
Debugging of code can become cumbersome in VBA 
Overall, the refactoring process proved beneficial as it relates to the project goal. Because we had the All-Stock Analysis workbook as a reference: it allowed us to have a starting point. As a result, we were able to compare performance resulting in increased performance outcomes.

# Resources  

## Performance Output results in seconds 

#### Exhibit A:  All Stock Analysis 2017

[![All-Stock-Analysis-2017.png](https://i.postimg.cc/zfC9fMk0/All-Stock-Analysis-2017.png)](https://postimg.cc/Y4SXndZW) 
  
#### Exhibit B:  VBA Challenge 2017

[![VBA-challenge-2017.png](https://i.postimg.cc/5y0GntWR/VBA-challenge-2017.png)](https://postimg.cc/HcqBLdxw) 

#### Exhibit C:  All Stock Analysis 2018 
[![All-Stock-Analysis-2018.png](https://i.postimg.cc/sX3bGc6y/All-Stock-Analysis-2018.png)](https://postimg.cc/WDf5QMcf)

#### Exhibit D:  VBA Challenge 2017
[![VBA-challenge-2018.png](https://i.postimg.cc/ZRj28d2N/VBA-challenge-2018.png)](https://postimg.cc/477WZmJ4) 




 

